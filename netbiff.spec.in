%define	name	@PACKAGE@
%define	version	@VERSION@
%define	release	1
%define prefix  /usr

Summary:	A more featureful version of the traditional biff
Name:		%{name}
Version:	%{version}
Release:	%{release}
Group:		X11/Utilities
Copyright:	GPL
Url:		http://www.cs.virginia.edu/~jrk3g/netbiff/
Vendor:		Jeff King <peff@acm.org>
Source:		http://www.cs.virginia.edu/~jrk3g/netbiff/%{name}-%{version}.tar.gz
Packager:	Jeff King <peff@acm.org>
Buildroot:	/tmp/%{name}-%{version}-root

%description
Netbiff is an advanced version of the traditional biff (a mail-checking
program). Features include BSD mailbox and IMAP4 support, a backend
plug-in system (for other protocols), arbitrary numbers of backends,
pluggable interfaces (GTK and text-based), and arbitrary actions on biff.

%package client-text
Summary: Mail notification utility text client
Group: Console/Utilities

%description client-text
Netbiff is an advanced version of the traditional biff (a mail-checking
program). Features include BSD mailbox and IMAP4 support, a backend
plug-in system (for other protocols), arbitrary numbers of backends, and
arbitrary actions on biff.

This is the text-only version.

%package client-gtk
Summary: Mail notification utility GTK client
Group: X11/Utilities

%description client-gtk
Netbiff is an advanced version of the traditional biff (a mail-checking
program). Features include BSD mailbox and IMAP4 support, a backend
plug-in system (for other protocols), arbitrary numbers of backends, and
arbitrary actions on biff.

This is the GTK version (it also supports the text interface).

%package backend-file
Summary: Netbiff backend for filesystems
Group: X11/Utilities

%description backend-file
Netbiffd is meant to be used as a backend to the netbiff mail checking
program. Netbiffd uses file system size checks and access/modification times
to check for file update (making it more versatile than simple mail folder
checking).

%package backend-imap
Summary: Netbiff backend for IMAP
Group: X11/Utilities

%description backend-imap
Netbiffd-imap is meant to be used as a backend to the netbiff mail checking
program.  Netbiffd-imap checks for mail over IMAP connections.

%prep
%setup -q

%build
CFLAGS="$RPM_OPT_FLAGS" \
	./configure --prefix=%{prefix} --disable-gtk
(cd netbiff && make)
cp netbiff/netbiff netbiff/netbiff-text

CFLAGS="$RPM_OPT_FLAGS" \
	./configure --prefix=%{prefix} --disable-gtk
(cd netbiff && make clean && make)
cp netbiff/netbiff netbiff/netbiff-gtk

(cd backend && make)

%build backend-file
CFLAGS="$RPM_OPT_FLAGS" \
	./configure --prefix=%{prefix}
make

%install
if [ -d $RPM_BUILD_ROOT ]; then rm -r $RPM_BUILD_ROOT; fi
mkdir -p $RPM_BUILD_ROOT/%{prefix}/{bin,man/man1}
make prefix=$RPM_BUILD_ROOT/%{prefix} install-strip

%clean
rm -r $RPM_BUILD_ROOT

%files
%doc AUTHORS COPYING ChangeLog INSTALL NEWS README TODO doc/* images
%defattr(-,root,root)

%files client-gtk
/usr/bin/netbiff

%files client-text
/usr/bin/netbiff

%files backend-file
/usr/bin/netbiffd

%files backend-imap
/usr/bin/netbiffd-imap

%changelog
* Sat May 13 2000 Jeff King <peff@acm.org>
- Split into backend/client packages

* Fri May 12 2000 Jeff King <peff@acm.org>
- Added netbiffd/netbiffd-imap packages

* Tue May 09 2000 Jeff King <peff@acm.org>
- Moved spec file to netbiff.spec.in for autogen of name/version

* Fri Jan 28 2000 Johnny Accot <accot@cena.fr>
  [netbiff-0.9.2-1]
- Initial packaging of version 0.9.2.

